<!-- ===== SISTEMA DE GESTIÓN DE ARCHIVOS PDF ===== -->
<!-- Agrega este código justo después de la sección de QR Admin en el panel administrativo -->

<style>
    /* ===== ESTILOS PARA EL SISTEMA DE ARCHIVOS PDF ===== */
    .pdf-files-section {
        background: var(--tracker-card);
        padding: 25px;
        border-radius: 10px;
        margin-bottom: 30px;
        border-left: 4px solid var(--tracker-primary);
    }
    
    .folders-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 20px;
        margin-top: 20px;
    }
    
    .folder-card {
        background: rgba(30, 41, 59, 0.8);
        border-radius: 10px;
        padding: 20px;
        cursor: pointer;
        transition: all 0.3s;
        border: 2px solid #334155;
        position: relative;
        overflow: hidden;
    }
    
    .folder-card:hover {
        transform: translateY(-5px);
        border-color: var(--tracker-primary);
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
    }
    
    .folder-card.active {
        border-color: var(--tracker-success);
        background: rgba(16, 185, 129, 0.1);
    }
    
    .folder-icon {
        font-size: 2.5rem;
        color: var(--tracker-warning);
        margin-bottom: 15px;
        text-align: center;
    }
    
    .folder-info {
        text-align: center;
    }
    
    .folder-name {
        color: white;
        font-size: 1.2rem;
        font-weight: 600;
        margin-bottom: 10px;
    }
    
    .folder-stats {
        display: flex;
        justify-content: space-between;
        margin-top: 15px;
        padding-top: 15px;
        border-top: 1px solid #334155;
    }
    
    .stat-item {
        text-align: center;
    }
    
    .stat-value {
        font-size: 1.5rem;
        font-weight: bold;
        color: white;
        display: block;
    }
    
    .stat-label {
        font-size: 0.8rem;
        color: #94a3b8;
    }
    
    .pdf-list-container {
        max-height: 500px;
        overflow-y: auto;
        margin-top: 20px;
        padding-right: 10px;
    }
    
    .pdf-item {
        background: rgba(255, 255, 255, 0.05);
        margin: 8px 0;
        padding: 15px;
        border-radius: 8px;
        border-left: 4px solid var(--tracker-primary);
        display: flex;
        justify-content: space-between;
        align-items: center;
        transition: all 0.3s;
    }
    
    .pdf-item:hover {
        background: rgba(255, 255, 255, 0.1);
        transform: translateX(5px);
    }
    
    .pdf-item-info {
        flex: 1;
    }
    
    .pdf-item-name {
        color: white;
        font-weight: 600;
        margin-bottom: 5px;
    }
    
    .pdf-item-details {
        color: #94a3b8;
        font-size: 0.8rem;
    }
    
    .pdf-item-actions {
        display: flex;
        gap: 10px;
    }
    
    .action-btn {
        background: none;
        border: none;
        color: #94a3b8;
        cursor: pointer;
        font-size: 1.2rem;
        padding: 5px;
        border-radius: 4px;
        transition: all 0.3s;
    }
    
    .action-btn:hover {
        background: rgba(255, 255, 255, 0.1);
        color: white;
    }
    
    .action-btn.view {
        color: var(--tracker-primary);
    }
    
    .action-btn.download {
        color: var(--tracker-success);
    }
    
    .action-btn.delete {
        color: var(--tracker-danger);
    }
    
    .empty-folder {
        text-align: center;
        padding: 40px 20px;
        color: #94a3b8;
    }
    
    .empty-folder i {
        font-size: 3rem;
        margin-bottom: 15px;
        display: block;
        color: #475569;
    }
    
    .upload-pdf-section {
        background: rgba(30, 41, 59, 0.8);
        padding: 20px;
        border-radius: 10px;
        margin-top: 30px;
        border-left: 4px solid var(--tracker-success);
    }
    
    .pdf-upload-area {
        border: 2px dashed #475569;
        border-radius: 10px;
        padding: 30px 20px;
        text-align: center;
        margin: 15px 0;
        cursor: pointer;
        transition: all 0.3s;
    }
    
    .pdf-upload-area:hover {
        border-color: var(--tracker-success);
        background: rgba(16, 185, 129, 0.05);
    }
    
    .pdf-upload-area.dragover {
        border-color: var(--tracker-success);
        background: rgba(16, 185, 129, 0.1);
    }
    
    .pdf-file-input {
        display: none;
    }
    
    .pdf-category-select {
        width: 100%;
        padding: 12px;
        background: #252f4a;
        border: 2px solid #334155;
        border-radius: 8px;
        color: white;
        margin: 15px 0;
        font-family: inherit;
    }
    
    .pdf-progress {
        height: 6px;
        background: #334155;
        border-radius: 3px;
        margin: 15px 0;
        overflow: hidden;
    }
    
    .pdf-progress-bar {
        height: 100%;
        width: 0%;
        background: linear-gradient(to right, var(--tracker-success), #219653);
        border-radius: 3px;
        transition: width 0.3s;
    }
    
    .pdf-search {
        width: 100%;
        padding: 12px;
        background: #252f4a;
        border: 2px solid #334155;
        border-radius: 8px;
        color: white;
        margin-bottom: 20px;
        font-family: inherit;
    }
    
    .pdf-search:focus {
        outline: none;
        border-color: var(--tracker-primary);
    }
    
    .pdf-filters {
        display: flex;
        gap: 10px;
        margin-bottom: 20px;
        flex-wrap: wrap;
    }
    
    .filter-btn {
        padding: 8px 15px;
        background: #252f4a;
        border: 2px solid #334155;
        border-radius: 8px;
        color: #94a3b8;
        cursor: pointer;
        transition: all 0.3s;
    }
    
    .filter-btn:hover, .filter-btn.active {
        background: var(--tracker-primary);
        color: white;
        border-color: var(--tracker-primary);
    }
    
    .pdf-stats-overview {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 15px;
        margin-bottom: 25px;
    }
    
    .pdf-stat-card {
        background: rgba(30, 41, 59, 0.8);
        padding: 15px;
        border-radius: 8px;
        text-align: center;
        border-top: 4px solid var(--tracker-primary);
    }
    
    .pdf-stat-card.total {
        border-top-color: var(--tracker-success);
    }
    
    .pdf-stat-card.published {
        border-top-color: var(--tracker-warning);
    }
    
    .pdf-stat-card.draft {
        border-top-color: var(--tracker-danger);
    }
    
    .pdf-stat-value {
        font-size: 2rem;
        font-weight: bold;
        color: white;
        margin: 10px 0;
    }
    
    .pdf-stat-label {
        color: #94a3b8;
        font-size: 0.9rem;
    }
</style>

<!-- ===== HTML PARA LA SECCIÓN DE ARCHIVOS PDF ===== -->
<div class="admin-section" id="adminPdfFiles">
    <h2 style="color: white; margin-bottom: 20px;"><i class="fas fa-file-pdf"></i> Gestión de Archivos PDF</h2>
    
    <div class="admin-content-container">
        <!-- Estadísticas rápidas -->
        <div class="pdf-stats-overview">
            <div class="pdf-stat-card total">
                <div class="pdf-stat-value" id="totalPdfs">0</div>
                <div class="pdf-stat-label">Total PDFs</div>
            </div>
            <div class="pdf-stat-card published">
                <div class="pdf-stat-value" id="publishedPdfs">0</div>
                <div class="pdf-stat-label">Publicados</div>
            </div>
            <div class="pdf-stat-card draft">
                <div class="pdf-stat-value" id="draftPdfs">0</div>
                <div class="pdf-stat-label">Borradores</div>
            </div>
            <div class="pdf-stat-card">
                <div class="pdf-stat-value" id="totalSize">0 MB</div>
                <div class="pdf-stat-label">Espacio usado</div>
            </div>
        </div>
        
        <!-- Filtros y búsqueda -->
        <div class="pdf-filters">
            <input type="text" class="pdf-search" id="pdfSearch" placeholder="Buscar PDF por nombre...">
            <button class="filter-btn active" data-filter="all">Todos</button>
            <button class="filter-btn" data-filter="published">Publicados</button>
            <button class="filter-btn" data-filter="draft">Borradores</button>
            <button class="filter-btn" data-filter="low-stock">Stock Bajo</button>
            <button class="filter-btn" data-filter="out-of-stock">Agotados</button>
        </div>
        
        <!-- Sistema de carpetas -->
        <div class="pdf-files-section">
            <h3 style="color: #94a3b8; margin-bottom: 20px;">
                <i class="fas fa-folder"></i> Carpetas de Categorías
                <span style="float: right; font-size: 0.9rem; color: var(--tracker-primary);" id="selectedFolderInfo">
                    Selecciona una carpeta
                </span>
            </h3>
            
            <div class="folders-grid" id="foldersContainer">
                <!-- Las carpetas se generarán automáticamente -->
            </div>
            
            <!-- Lista de PDFs en la carpeta seleccionada -->
            <div id="pdfListContainer" style="display: none;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin: 25px 0 15px 0;">
                    <h4 style="color: white;" id="currentFolderTitle">
                        <i class="fas fa-folder-open"></i> 
                        <span id="currentFolderName">Carpeta</span>
                        <span style="color: #94a3b8; font-size: 0.9rem; margin-left: 10px;">
                            (<span id="currentFolderCount">0</span> archivos)
                        </span>
                    </h4>
                    <button class="tracker-btn" id="backToFoldersBtn" style="padding: 8px 15px;">
                        <i class="fas fa-arrow-left"></i> Volver a carpetas
                    </button>
                </div>
                
                <div class="pdf-list-container" id="pdfList">
                    <!-- Los PDFs se cargarán aquí dinámicamente -->
                </div>
                
                <!-- Sección para subir nuevos PDFs a esta carpeta -->
                <div class="upload-pdf-section" id="uploadToFolderSection">
                    <h4 style="color: #94a3b8; margin-bottom: 15px;">
                        <i class="fas fa-upload"></i> Subir nuevo PDF a esta carpeta
                    </h4>
                    
                    <div class="pdf-upload-area" id="pdfUploadArea">
                        <i class="fas fa-cloud-upload-alt" style="font-size: 2.5rem; color: #475569; margin-bottom: 15px;"></i>
                        <p style="color: #94a3b8; margin-bottom: 10px;">Arrastra y suelta archivos PDF aquí o haz clic para seleccionar</p>
                        <p style="color: #64748b; font-size: 0.9rem;">Tamaño máximo: 50MB por archivo</p>
                        <input type="file" class="pdf-file-input" id="pdfFileInput" accept=".pdf">
                        <button class="tracker-btn" id="browsePdfBtn" style="margin-top: 15px;">
                            <i class="fas fa-folder-open"></i> Buscar PDF
                        </button>
                    </div>
                    
                    <div id="selectedPdfInfo" style="display: none; margin-top: 20px;">
                        <div style="background: #252f4a; padding: 15px; border-radius: 8px;">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <div style="color: white; font-weight: 600;" id="selectedPdfName"></div>
                                    <div style="color: #94a3b8; font-size: 0.9rem;" id="selectedPdfSize"></div>
                                </div>
                                <button class="action-btn delete" id="removePdfBtn">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Configuración del PDF -->
                    <div style="margin-top: 20px;">
                        <div style="margin-bottom: 15px;">
                            <label style="color: #94a3b8; display: block; margin-bottom: 8px;">Título del libro:</label>
                            <input type="text" id="pdfTitle" placeholder="Ej: Fusion Caribeña con IA" style="width: 100%; padding: 12px; background: #252f4a; border: 2px solid #334155; border-radius: 8px; color: white;">
                        </div>
                        
                        <div style="margin-bottom: 15px;">
                            <label style="color: #94a3b8; display: block; margin-bottom: 8px;">Descripción:</label>
                            <textarea id="pdfDescription" placeholder="Breve descripción del contenido del libro..." rows="3" style="width: 100%; padding: 12px; background: #252f4a; border: 2px solid #334155; border-radius: 8px; color: white; resize: vertical;"></textarea>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                            <div>
                                <label style="color: #94a3b8; display: block; margin-bottom: 8px;">Precio (USD):</label>
                                <input type="number" id="pdfPrice" placeholder="9.99" min="0" step="0.01" style="width: 100%; padding: 12px; background: #252f4a; border: 2px solid #334155; border-radius: 8px; color: white;">
                            </div>
                            <div>
                                <label style="color: #94a3b8; display: block; margin-bottom: 8px;">Stock inicial:</label>
                                <input type="number" id="pdfStock" placeholder="10" min="0" step="1" style="width: 100%; padding: 12px; background: #252f4a; border: 2px solid #334155; border-radius: 8px; color: white;">
                            </div>
                        </div>
                        
                        <div style="margin-bottom: 15px;">
                            <label style="color: #94a3b8; display: block; margin-bottom: 8px;">Categoría:</label>
                            <select class="pdf-category-select" id="pdfCategory">
                                <option value="cocina-cubana">Cocina Cubana</option>
                                <option value="cocina-internacional">Cocina Internacional</option>
                                <option value="postres-dulces">Postres y Dulces</option>
                                <option value="recetas-saludables">Recetas Saludables</option>
                                <option value="cocina-rapida">Cocina Rápida</option>
                                <option value="tecnicas-culinarias">Técnicas Culinarias</option>
                            </select>
                        </div>
                        
                        <div style="display: flex; gap: 10px; margin-top: 20px;">
                            <button class="tracker-btn" style="flex: 1;" id="uploadPdfBtn">
                                <i class="fas fa-upload"></i> Subir PDF
                            </button>
                            <button class="tracker-btn" style="flex: 1; background: #475569;" id="cancelUploadBtn">
                                <i class="fas fa-times"></i> Cancelar
                            </button>
                        </div>
                        
                        <div id="pdfUploadProgress" style="display: none; margin-top: 20px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                <span style="color: #94a3b8;">Progreso:</span>
                                <span style="color: #94a3b8;" id="pdfProgressText">0%</span>
                            </div>
                            <div class="pdf-progress">
                                <div class="pdf-progress-bar" id="pdfProgressBar"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- ===== JAVASCRIPT PARA EL SISTEMA DE ARCHIVOS PDF ===== -->
<script>
    // ===== BASE DE DATOS PARA ARCHIVOS PDF =====
    class PdfDatabase {
        constructor() {
            this.dbName = 'pdf_files_db';
            this.initDatabase();
        }
        
        initDatabase() {
            if (!localStorage.getItem(this.dbName)) {
                const initialData = {
                    categories: {
                        'cocina-cubana': {
                            name: 'Cocina Cubana Tradicional',
                            icon: 'fas fa-utensils',
                            color: '#e74c3c',
                            description: 'Recetas auténticas de la cocina cubana'
                        },
                        'cocina-internacional': {
                            name: 'Cocina Internacional',
                            icon: 'fas fa-globe-americas',
                            color: '#3498db',
                            description: 'Platos de todo el mundo'
                        },
                        'postres-dulces': {
                            name: 'Postres y Dulces',
                            icon: 'fas fa-cookie-bite',
                            color: '#f39c12',
                            description: 'Dulces, postres y repostería'
                        },
                        'recetas-saludables': {
                            name: 'Recetas Saludables',
                            icon: 'fas fa-heart',
                            color: '#2ecc71',
                            description: 'Comida sana y nutritiva'
                        },
                        'cocina-rapida': {
                            name: 'Cocina Rápida',
                            icon: 'fas fa-bolt',
                            color: '#9b59b6',
                            description: 'Recetas rápidas y fáciles'
                        },
                        'tecnicas-culinarias': {
                            name: 'Técnicas Culinarias',
                            icon: 'fas fa-graduation-cap',
                            color: '#1abc9c',
                            description: 'Técnicas y métodos de cocina'
                        }
                    },
                    files: [
                        {
                            id: 'LIB001',
                            title: 'Fusión Caribeña con IA',
                            description: 'Recetas tradicionales cubanas reinventadas con toques modernos usando inteligencia artificial.',
                            filename: 'fusion-caribena-ia.pdf',
                            category: 'cocina-cubana',
                            price: 9.99,
                            stock: 15,
                            sold: 45,
                            published: true,
                            size: 2.5, // MB
                            uploadDate: new Date().toISOString(),
                            lastModified: new Date().toISOString()
                        },
                        {
                            id: 'LIB002',
                            title: 'Cocina Internacional AI',
                            description: 'Platos de 5 continentes generados por inteligencia artificial con ingredientes accesibles en Cuba.',
                            filename: 'cocina-internacional-ai.pdf',
                            category: 'cocina-internacional',
                            price: 7.99,
                            stock: 3,
                            sold: 28,
                            published: true,
                            size: 3.1,
                            uploadDate: new Date().toISOString(),
                            lastModified: new Date().toISOString()
                        },
                        {
                            id: 'LIB003',
                            title: 'Postres con Chat GPT',
                            description: 'Dulces y postres creados completamente por IA, desde lo tradicional hasta innovaciones únicas.',
                            filename: 'postres-chatgpt.pdf',
                            category: 'postres-dulces',
                            price: 6.99,
                            stock: 22,
                            sold: 32,
                            published: true,
                            size: 1.8,
                            uploadDate: new Date().toISOString(),
                            lastModified: new Date().toISOString()
                        }
                    ]
                };
                localStorage.setItem(this.dbName, JSON.stringify(initialData));
            }
        }
        
        getDatabase() {
            return JSON.parse(localStorage.getItem(this.dbName));
        }
        
        updateDatabase(data) {
            localStorage.setItem(this.dbName, JSON.stringify(data));
        }
        
        // ===== CATEGORÍAS =====
        getCategories() {
            return this.getDatabase().categories;
        }
        
        getCategory(categoryId) {
            const categories = this.getCategories();
            return categories[categoryId] || null;
        }
        
        // ===== ARCHIVOS PDF =====
        getFiles(filter = 'all', category = null, search = '') {
            const db = this.getDatabase();
            let files = [...db.files];
            
            // Aplicar filtros
            if (filter === 'published') {
                files = files.filter(file => file.published);
            } else if (filter === 'draft') {
                files = files.filter(file => !file.published);
            } else if (filter === 'low-stock') {
                files = files.filter(file => file.stock > 0 && file.stock <= 5);
            } else if (filter === 'out-of-stock') {
                files = files.filter(file => file.stock === 0);
            }
            
            // Filtrar por categoría
            if (category) {
                files = files.filter(file => file.category === category);
            }
            
            // Buscar por texto
            if (search) {
                const searchLower = search.toLowerCase();
                files = files.filter(file => 
                    file.title.toLowerCase().includes(searchLower) ||
                    file.description.toLowerCase().includes(searchLower) ||
                    file.filename.toLowerCase().includes(searchLower)
                );
            }
            
            return files;
        }
        
        getFile(fileId) {
            const files = this.getFiles();
            return files.find(file => file.id === fileId);
        }
        
        getFilesByCategory(categoryId) {
            return this.getFiles('all', categoryId);
        }
        
        addFile(fileData) {
            const db = this.getDatabase();
            
            // Generar ID único si no existe
            if (!fileData.id) {
                fileData.id = 'LIB' + Date.now().toString().slice(-6);
            }
            
            fileData.uploadDate = new Date().toISOString();
            fileData.lastModified = new Date().toISOString();
            
            db.files.unshift(fileData);
            this.updateDatabase(db);
            
            return fileData;
        }
        
        updateFile(fileId, updates) {
            const db = this.getDatabase();
            const fileIndex = db.files.findIndex(file => file.id === fileId);
            
            if (fileIndex !== -1) {
                db.files[fileIndex] = {
                    ...db.files[fileIndex],
                    ...updates,
                    lastModified: new Date().toISOString()
                };
                this.updateDatabase(db);
                return db.files[fileIndex];
            }
            
            return null;
        }
        
        deleteFile(fileId) {
            const db = this.getDatabase();
            const initialLength = db.files.length;
            db.files = db.files.filter(file => file.id !== fileId);
            this.updateDatabase(db);
            return initialLength !== db.files.length;
        }
        
        updateStock(fileId, newStock) {
            return this.updateFile(fileId, { stock: newStock });
        }
        
        incrementSold(fileId, quantity = 1) {
            const file = this.getFile(fileId);
            if (file) {
                const newStock = Math.max(0, file.stock - quantity);
                const newSold = file.sold + quantity;
                return this.updateFile(fileId, { 
                    stock: newStock, 
                    sold: newSold 
                });
            }
            return null;
        }
        
        // ===== ESTADÍSTICAS =====
        getStats() {
            const files = this.getFiles();
            const published = files.filter(f => f.published).length;
            const drafts = files.filter(f => !f.published).length;
            const totalSize = files.reduce((sum, file) => sum + (file.size || 0), 0);
            
            // Calcular stock bajo y agotado
            const lowStock = files.filter(f => f.stock > 0 && f.stock <= 5).length;
            const outOfStock = files.filter(f => f.stock === 0).length;
            
            // Calcular ventas totales
            const totalSales = files.reduce((sum, file) => sum + (file.sold || 0), 0);
            const totalRevenue = files.reduce((sum, file) => sum + (file.sold * file.price), 0);
            
            return {
                total: files.length,
                published,
                drafts,
                totalSize: (totalSize / 1024).toFixed(2), // Convertir a MB
                lowStock,
                outOfStock,
                totalSales,
                totalRevenue: totalRevenue.toFixed(2)
            };
        }
        
        getCategoryStats() {
            const categories = this.getCategories();
            const files = this.getFiles();
            
            const stats = {};
            Object.keys(categories).forEach(categoryId => {
                const categoryFiles = files.filter(f => f.category === categoryId);
                const published = categoryFiles.filter(f => f.published).length;
                const totalStock = categoryFiles.reduce((sum, f) => sum + f.stock, 0);
                const totalSold = categoryFiles.reduce((sum, f) => sum + f.sold, 0);
                const totalSize = categoryFiles.reduce((sum, f) => sum + (f.size || 0), 0);
                
                stats[categoryId] = {
                    total: categoryFiles.length,
                    published,
                    totalStock,
                    totalSold,
                    totalSize: (totalSize / 1024).toFixed(2)
                };
            });
            
            return stats;
        }
    }

    // ===== VARIABLES GLOBALES PARA PDF =====
    const pdfDatabase = new PdfDatabase();
    let selectedCategory = null;
    let currentFilter = 'all';
    let selectedFile = null;

    // ===== FUNCIONES PRINCIPALES =====
    function initializePdfManager() {
        updatePdfStats();
        loadCategories();
        setupPdfEventListeners();
    }

    function updatePdfStats() {
        const stats = pdfDatabase.getStats();
        
        document.getElementById('totalPdfs').textContent = stats.total;
        document.getElementById('publishedPdfs').textContent = stats.published;
        document.getElementById('draftPdfs').textContent = stats.drafts;
        document.getElementById('totalSize').textContent = stats.totalSize + ' MB';
    }

    function loadCategories() {
        const categories = pdfDatabase.getCategories();
        const categoryStats = pdfDatabase.getCategoryStats();
        const foldersContainer = document.getElementById('foldersContainer');
        
        foldersContainer.innerHTML = '';
        
        Object.keys(categories).forEach(categoryId => {
            const category = categories[categoryId];
            const stats = categoryStats[categoryId] || { total: 0, published: 0, totalStock: 0, totalSold: 0 };
            
            const folderCard = document.createElement('div');
            folderCard.className = 'folder-card';
            folderCard.dataset.category = categoryId;
            
            folderCard.innerHTML = `
                <div class="folder-icon">
                    <i class="${category.icon}"></i>
                </div>
                <div class="folder-info">
                    <div class="folder-name">${category.name}</div>
                    <div style="color: #94a3b8; font-size: 0.9rem; margin-bottom: 10px;">
                        ${category.description}
                    </div>
                </div>
                <div class="folder-stats">
                    <div class="stat-item">
                        <span class="stat-value">${stats.total}</span>
                        <span class="stat-label">Archivos</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value">${stats.totalStock}</span>
                        <span class="stat-label">Stock</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value">${stats.totalSold}</span>
                        <span class="stat-label">Vendidos</span>
                    </div>
                </div>
            `;
            
            folderCard.addEventListener('click', () => selectCategory(categoryId));
            foldersContainer.appendChild(folderCard);
        });
    }

    function selectCategory(categoryId) {
        selectedCategory = categoryId;
        
        // Actualizar UI de carpetas
        document.querySelectorAll('.folder-card').forEach(card => {
            card.classList.remove('active');
            if (card.dataset.category === categoryId) {
                card.classList.add('active');
            }
        });
        
        // Mostrar información de la carpeta seleccionada
        const category = pdfDatabase.getCategory(categoryId);
        const stats = pdfDatabase.getCategoryStats()[categoryId] || { total: 0 };
        
        document.getElementById('selectedFolderInfo').innerHTML = `
            <i class="fas fa-folder-open"></i> ${category.name} (${stats.total} archivos)
        `;
        
        // Mostrar lista de PDFs
        showPdfList(categoryId);
    }

    function showPdfList(categoryId) {
        const category = pdfDatabase.getCategory(categoryId);
        const files = pdfDatabase.getFiles(currentFilter, categoryId, document.getElementById('pdfSearch').value);
        
        // Ocultar carpetas, mostrar lista
        document.getElementById('foldersContainer').style.display = 'none';
        document.getElementById('pdfListContainer').style.display = 'block';
        
        // Actualizar título
        document.getElementById('currentFolderName').textContent = category.name;
        document.getElementById('currentFolderCount').textContent = files.length;
        
        // Cargar lista de PDFs
        const pdfList = document.getElementById('pdfList');
        pdfList.innerHTML = '';
        
        if (files.length === 0) {
            pdfList.innerHTML = `
                <div class="empty-folder">
                    <i class="fas fa-file-pdf"></i>
                    <p>No hay archivos PDF en esta carpeta</p>
                    <p style="color: #64748b; font-size: 0.9rem; margin-top: 10px;">
                        Sube tu primer archivo usando el formulario de abajo
                    </p>
                </div>
            `;
        } else {
            files.forEach(file => {
                const pdfItem = createPdfItem(file);
                pdfList.appendChild(pdfItem);
            });
        }
        
        // Mostrar sección de subida
        document.getElementById('uploadToFolderSection').style.display = 'block';
    }

    function createPdfItem(file) {
        const pdfItem = document.createElement('div');
        pdfItem.className = 'pdf-item';
        pdfItem.dataset.fileId = file.id;
        
        const stockStatus = file.stock === 0 ? 'stock-low' : (file.stock <= 5 ? 'stock-warning' : 'stock-ok');
        const stockText = file.stock === 0 ? 'Agotado' : (file.stock <= 5 ? `Stock bajo (${file.stock})` : `Disponible (${file.stock})`);
        
        pdfItem.innerHTML = `
            <div class="pdf-item-info">
                <div class="pdf-item-name">${file.title}</div>
                <div class="pdf-item-details">
                    <span style="margin-right: 15px;">
                        <i class="fas fa-dollar-sign"></i> ${file.price} USD
                    </span>
                    <span style="margin-right: 15px;">
                        <i class="fas fa-box"></i> ${stockText}
                    </span>
                    <span style="margin-right: 15px;">
                        <i class="fas fa-chart-line"></i> ${file.sold || 0} vendidos
                    </span>
                    <span style="margin-right: 15px;">
                        <i class="fas fa-hdd"></i> ${file.size || '0'} MB
                    </span>
                    <span style="color: ${file.published ? '#2ecc71' : '#f39c12'};">
                        <i class="fas fa-circle"></i> ${file.published ? 'Publicado' : 'Borrador'}
                    </span>
                </div>
                <div style="color: #94a3b8; font-size: 0.8rem; margin-top: 5px;">
                    ${file.description}
                </div>
            </div>
            <div class="pdf-item-actions">
                <button class="action-btn view" data-action="view" data-file-id="${file.id}">
                    <i class="fas fa-eye"></i>
                </button>
                <button class="action-btn download" data-action="download" data-file-id="${file.id}">
                    <i class="fas fa-download"></i>
                </button>
                <button class="action-btn delete" data-action="delete" data-file-id="${file.id}">
                    <i class="fas fa-trash"></i>
                </button>
            </div>
        `;
        
        return pdfItem;
    }

    function setupPdfEventListeners() {
        // Botón para volver a carpetas
        document.getElementById('backToFoldersBtn').addEventListener('click', () => {
            document.getElementById('foldersContainer').style.display = 'grid';
            document.getElementById('pdfListContainer').style.display = 'none';
            selectedCategory = null;
            
            document.querySelectorAll('.folder-card').forEach(card => {
                card.classList.remove('active');
            });
        });
        
        // Filtros
        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                e.currentTarget.classList.add('active');
                currentFilter = e.currentTarget.dataset.filter;
                
                if (selectedCategory) {
                    showPdfList(selectedCategory);
                }
            });
        });
        
        // Búsqueda
        document.getElementById('pdf
